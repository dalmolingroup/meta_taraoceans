rm(data_name, vari_name, index, taxon)
}
### Salvando imagens
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/final/taxo_",taxon,".png")
ggsave(filename = vari_name, data_name,
width = 7, height = 5, dpi = 500, units = "in", device='png')
rm(data_name, vari_name, taxon)
}
setwd("~/Documentos/meta_taraocean/data/results/version02_final/code/taxonomic")
setwd("~/Documentos/meta_taraocean/data/results/version02_final/code/taxonomic")
taxo_kingdom
### Salvando imagens (PDF)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/pdf/taxo/taxo_",taxon,".pdf")
ggsave(filename = vari_name, data_name + theme_light(),
width = 15, height = 10, dpi = 500, units = "cm", device='pdf')
rm(data_name, vari_name, taxon)
}
# Carregando as bibliotecas
library(dplyr); library(tidyr); library(ggplot2);
library(pals); library(factoextra); library(patchwork)
# Carregando as bibliotecas
library(dplyr); library(tidyr); library(ggplot2);
library(pals); library(factoextra); library(patchwork)
### Salvando imagens (PDF)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/pdf/taxo/taxo_",taxon,".pdf")
ggsave(filename = vari_name, data_name + theme_light(),
width = 15, height = 10, dpi = 500, units = "cm", device='pdf')
rm(data_name, vari_name, taxon)
}
### Salvando imagens (PDF)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/pdf/taxo_",taxon,".pdf")
ggsave(filename = vari_name, data_name + theme_light(),
width = 15, height = 10, dpi = 500, units = "cm", device='pdf')
rm(data_name, vari_name, taxon)
}
### Salvando imagens (PNG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/png/taxo_",taxon,".png")
ggsave(filename = vari_name, data_name + theme_light(),
width = 15, height = 10, dpi = 500, units = "cm", device='png')
rm(data_name, vari_name, taxon)
}
### Salvando imagens (SVG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/svg/taxo_",taxon,".svg")
dev.copy(svg,vari_name,width = 7,height = 5)
dev.off()
rm(data_name, vari_name, taxon)
}
### Salvando imagens (SVG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/svg/taxo_",taxon,".svg")
dev.copy(svg,vari_name,width = 7,height = 5)
dev.off()
# rm(data_name, vari_name, taxon)
}
taxon
### Salvando imagens (SVG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/svg/taxo_",taxon,".svg")
dev.copy(svg,vari_name,width = 7,height = 5)
dev.off()
# rm(data_name, vari_name, taxon)
}
taxon
taxons
### Salvando imagens (SVG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/png/taxo_",taxon,".png")
dev.copy(svg,vari_name,width = 7,height = 5)
dev.off()
# rm(data_name, vari_name, taxon)
}
### Salvando imagens (SVG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/png/taxo_",taxon,".png")
dev.copy(svg,vari_name,width = 7,height = 5)
dev.off()
# rm(data_name, vari_name, taxon)
}
### Salvando imagens (PNG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/png/taxo_",taxon,".png")
ggsave(filename = vari_name, data_name + theme_light(),
width = 15, height = 10, dpi = 500, units = "cm", device='png')
rm(data_name, vari_name, taxon)
}
### Salvando imagens (SVG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/svg/taxo_",taxon,".svg")
dev.copy(svg,vari_name,width = 7,height = 5)
dev.off()
# rm(data_name, vari_name, taxon)
}
### Salvando imagens (SVG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/svg/taxo_",taxon,".svg")
dev.copy(svg,vari_name,width = 7,height = 5)
dev.off()
rm(data_name, vari_name, taxon)
}
taxo_kingdom
dev.copy(svg, paste0("plots/svg/taxo_",taxon,".svg"), width = 7, height = 5)
taxo_kingdom
dev.copy(svg, paste0("plots/svg/taxo_kingdom.svg"), width = 7, height = 5)
dev.off()
taxo_kingdom
dev.copy(svg, paste0("plots/svg/taxo_kingdom.svg"), width = 7, height = 5)
dev.off()
taxo_phylum
dev.copy(svg, paste0("plots/svg/taxo_phylum.svg"), width = 7, height = 5)
dev.off()
taxo_class
dev.copy(svg, paste0("plots/svg/taxo_class.svg"), width = 7, height = 5)
dev.off()
taxo_order
dev.copy(svg, paste0("plots/svg/taxo_order.svg"), width = 7, height = 5)
dev.off()
taxo_family
dev.copy(svg, paste0("plots/svg/taxo_family.svg"), width = 7, height = 5)
dev.off()
taxo_genus
dev.copy(svg, paste0("plots/svg/taxo_genus.svg"), width = 7, height = 5)
dev.off()
taxo_species
dev.copy(svg, paste0("plots/svg/taxo_species.svg"), width = 7, height = 5)
dev.off()
### Salvando imagens (PNG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/png/taxo_",taxon,".png")
ggsave(filename = vari_name, data_name + theme_light(),
width = 15, height = 10, dpi = 500, units = "cm", device='png')
rm(data_name, vari_name, taxon)
}
taxo_kingdom
taxo_phylum
# Plotando
taxo_kingdom <- ggplot(dataplot_kingdom, aes(fill=condition_kingdom, y=value_kingdom, x=sample_kingdom)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal_kgd, name  = "Domains") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_kingdom
# Plotando
taxo_phylum <- ggplot(dataplot_phylum, aes(fill=condition_phylum, y=value_phylum, x=sample_phylum)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal, name  = "Phyla") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_phylum
# Plotando
taxo_class <- ggplot(dataplot_class, aes(fill=condition_class, y=value_class, x=sample_class)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal, name  = "Classes") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_class
# Plotando
taxo_order <- ggplot(dataplot_order, aes(fill=condition_order, y=value_order, x=sample_order)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal, name  = "Ordens") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_order
# Plotando
taxo_family <- ggplot(dataplot_family, aes(fill=condition_family, y=value_family, x=sample_family)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal, name  = "FamÃ­lias") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_family
# Plotando
taxo_genus <- ggplot(dataplot_genus, aes(fill=condition_genus, y=value_genus, x=sample_genus)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal3, name  = "Genera") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_genus
# Plotando
taxo_species <- ggplot(dataplot_species, aes(fill=condition_species, y=value_species, x=sample_species)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal3, name  = "Species") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_species
### Salvando imagens (PDF)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/pdf/taxo_",taxon,".pdf")
ggsave(filename = vari_name, data_name + theme_light(),
width = 15, height = 10, dpi = 500, units = "cm", device='pdf')
rm(data_name, vari_name, taxon)
}
rm(taxo_kingdom,taxo_phylum,taxo_class)
rm(taxo_order, taxo_family,taxo_genus,taxo_species)
### Salvando imagens (PDF)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/pdf/taxo_",taxon,".pdf")
ggsave(filename = vari_name, data_name + theme_light(),
width = 15, height = 10, dpi = 500, units = "cm", device='pdf')
rm(data_name, vari_name, taxon)
}
# Plotando
taxo_kingdom <- ggplot(dataplot_kingdom, aes(fill=condition_kingdom, y=value_kingdom, x=sample_kingdom)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal_kgd, name  = "Domains") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_kingdom
# Plotando
taxo_phylum <- ggplot(dataplot_phylum, aes(fill=condition_phylum, y=value_phylum, x=sample_phylum)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal, name  = "Phyla") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_phylum
# Plotando
taxo_class <- ggplot(dataplot_class, aes(fill=condition_class, y=value_class, x=sample_class)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal, name  = "Classes") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_class
# Plotando
taxo_order <- ggplot(dataplot_order, aes(fill=condition_order, y=value_order, x=sample_order)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal, name  = "Ordens") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_order
# Plotando
taxo_family <- ggplot(dataplot_family, aes(fill=condition_family, y=value_family, x=sample_family)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal, name  = "FamÃ­lias") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_family
# Plotando
taxo_genus <- ggplot(dataplot_genus, aes(fill=condition_genus, y=value_genus, x=sample_genus)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal3, name  = "Genera") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_genus
# Plotando
taxo_species <- ggplot(dataplot_species, aes(fill=condition_species, y=value_species, x=sample_species)) +
geom_bar(position="fill", stat="identity") +
scale_fill_manual(values = mat_pal3, name  = "Species") +
labs(title = '',
y = 'Frequency',
x = 'Samples') +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(vjust=0.6, angle=90),
legend.position = "none")
taxo_species
### Salvando imagens (PDF)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/pdf/taxo_",taxon,".pdf")
ggsave(filename = vari_name, data_name + theme_light(),
width = 15, height = 10, dpi = 500, units = "cm", device='pdf')
rm(data_name, vari_name, taxon)
}
### Salvando imagens (PDF)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/pdf/taxo_",taxon,".pdf")
ggsave(filename = vari_name, data_name,
width = 15, height = 10, dpi = 500, units = "cm", device='pdf')
rm(data_name, vari_name, taxon)
}
### Salvando imagens (PNG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/png/taxo_",taxon,".png")
ggsave(filename = vari_name, data_name + theme_light(),
width = 15, height = 10, dpi = 500, units = "cm", device='png')
rm(data_name, vari_name, taxon)
}
### Salvando imagens (PNG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/png/taxo_",taxon,".png")
ggsave(filename = vari_name, data_name,
width = 15, height = 10, dpi = 500, units = "cm", device='png')
rm(data_name, vari_name, taxon)
}
### Salvando imagens (SVG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/svg/taxo_",taxon,".svg")
dev.copy(svg,vari_name,width = 7,height = 5)
dev.off()
rm(data_name, vari_name, taxon)
}
### Salvando imagens (SVG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/svg/taxo_",taxon,".svg")
dev.copy(svg,vari_name,width = 7,height = 5)
dev.off()
rm(data_name, vari_name, taxon)
}
taxon
taxons
### Salvando imagens (SVG)
for (taxon in taxons){
data_name <- get(paste0("taxo_",taxon))
vari_name <- paste0("plots/svg/taxo_",taxon,".svg")
dev.copy(svg,vari_name,width = 7,height = 5)
dev.off()
# rm(data_name, vari_name, taxon)
}
taxon
### Salvando imagens (SVG)
for (taxon in taxons){
vari_name <- paste0("plots/svg/taxo_",taxon,".svg")
data_name <- get(paste0("taxo_",taxon))
dev.copy(svg,vari_name,width = 7,height = 5)
dev.off()
# rm(data_name, vari_name, taxon)
}
taxo_kingdom
dev.copy(svg, paste0("plots/svg/taxo_kingdom.svg"), width = 7, height = 5)
dev.off()
taxo_phylum
dev.copy(svg, paste0("plots/svg/taxo_phylum.svg"), width = 7, height = 5)
dev.off()
taxo_class
dev.copy(svg, paste0("plots/svg/taxo_class.svg"), width = 7, height = 5)
dev.off()
taxo_order
dev.copy(svg, paste0("plots/svg/taxo_order.svg"), width = 7, height = 5)
dev.off()
taxo_family
dev.copy(svg, paste0("plots/svg/taxo_family.svg"), width = 7, height = 5)
dev.off()
taxo_genus
dev.copy(svg, paste0("plots/svg/taxo_genus.svg"), width = 7, height = 5)
dev.off()
taxo_species
dev.copy(svg, paste0("plots/svg/taxo_species.svg"), width = 7, height = 5)
dev.off()
###################################################################### DEFININDO VARIAVEIS ######################################################################
path="~/meta_taraocean/data/results/input/taxonomic/"
taxons <- c("kingdom", "phylum", "class", "order", "family", "genus", "species")
runs <- c("ERR594324","ERR598972","ERR599023","ERR599025","ERR594385","ERR599021","ERR599164","ERR598970",
"ERR599088","ERR599150","ERR594392","ERR594291","ERR598990","ERR599018","ERR599110","ERR594382",
"ERR594414","ERR598960","ERR599034","ERR594320","ERR598979","ERR599146","ERR594359","ERR594361",
"ERR599017","ERR599056","ERR599103","ERR594294","ERR594348","ERR594415","ERR598947","ERR599131",
"ERR594302","ERR599129","ERR599171","ERR599174","ERR594318","ERR594297","ERR594391","ERR599040",
"ERR599148","ERR594321","ERR594298","ERR594355","ERR599000","ERR599154","ERR594333","ERR599010",
"ERR599126","ERR594310","ERR594286","ERR594354","ERR599046","ERR599101","ERR594336","ERR594303",
"ERR599124","ERR599159","ERR594289","ERR599006","ERR599022","ERR594340","ERR594332","ERR594411",
"ERR599042","ERR599079","ERR599071","ERR599085","ERR599093","ERR599120","ERR598961","ERR599086",
"ERR599077","ERR598957","ERR599072","ERR598954")
###################################################################### RESGATANDO AMOSTRAS ######################################################################
for (run in runs) {
for (taxon in taxons){
file_name <- paste0(path,taxon,"_",run,"_names.txt")
vari_name <- paste0("rawdata_",run,"_",taxon)
assign(vari_name, read.csv(file_name, sep = "\t", header = FALSE, stringsAsFactors = FALSE))
rm(file_name, vari_name)
}
rm(run, taxon)
}
###################################################################### DEFININDO VARIAVEIS ######################################################################
path="~/meta_taraocean/data/results/input/taxonomic/"
taxons <- c("kingdom", "phylum", "class", "order", "family", "genus", "species")
runs <- c("ERR594324","ERR598972","ERR599023","ERR599025","ERR594385","ERR599021","ERR599164","ERR598970",
"ERR599088","ERR599150","ERR594392","ERR594291","ERR598990","ERR599018","ERR599110","ERR594382",
"ERR594414","ERR598960","ERR599034","ERR594320","ERR598979","ERR599146","ERR594359","ERR594361",
"ERR599017","ERR599056","ERR599103","ERR594294","ERR594348","ERR594415","ERR598947","ERR599131",
"ERR594302","ERR599129","ERR599171","ERR599174","ERR594318","ERR594297","ERR594391","ERR599040",
"ERR599148","ERR594321","ERR594298","ERR594355","ERR599000","ERR599154","ERR594333","ERR599010",
"ERR599126","ERR594310","ERR594286","ERR594354","ERR599046","ERR599101","ERR594336","ERR594303",
"ERR599124","ERR599159","ERR594289","ERR599006","ERR599022","ERR594340","ERR594332","ERR594411",
"ERR599042","ERR599079","ERR599071","ERR599085","ERR599093","ERR599120","ERR598961","ERR599086",
"ERR599077","ERR598957","ERR599072","ERR598954")
###################################################################### RESGATANDO AMOSTRAS ######################################################################
for (run in runs) {
for (taxon in taxons){
file_name <- paste0(path,taxon,"_",run,"_names.txt")
vari_name <- paste0("rawdata_",run,"_",taxon)
assign(vari_name, read.csv(file_name, sep = "\t", header = FALSE, stringsAsFactors = FALSE))
rm(file_name, vari_name)
}
rm(run, taxon)
}
###################################################################### RENOMEANDO COLUNAS ######################################################################
for (run in runs) {
for (taxon in taxons){
data_name <- get(paste0("rawdata_",run,"_",taxon))
names(data_name)[1:2] <- c(taxon, "n")
assign(paste0("rawdata_",run,"_",taxon), data_name)
rm(data_name)
}
rm(run, taxon)
}
###################################################################### ORDENANDO DATAFRAMES ######################################################################
for (run in runs) {
for (taxon in taxons){
data_name <- get(paste0("rawdata_",run,"_",taxon))
vari_name <- paste0("order_",run,"_",taxon)
assign(vari_name, data_name[order(data_name$n, decreasing = TRUE), ])
rm(data_name, vari_name)
}
rm(run, taxon)
}
###################################################################### Limpando dados --> Convertendo NAs ######################################################################
for (run in runs) {
for (taxon in taxons){
data_name <- get(paste0("order_",run,"_",taxon))
data_name[is.na(data_name)] <- "unclassified"
assign(paste0("order_",run,"_",taxon), data_name)
rm(data_name)
}
rm(run,taxon)
}
############################## Resgatando os 11 mais frequentes (incluindo os indefinidos) ##############################
for (run in runs) {
for (taxon in taxons){
data_name <- get(paste0("order_",run,"_",taxon))
vari_name <- paste0("themore_",run,"_",taxon)
assign(vari_name, data_name[1:11,])
rm(data_name, vari_name)
}
rm(run, taxon)
}
############################## Resgatando os 10 mais frequentes (excluindo os indefinidos) ##############################
### FOR NA
for (run in runs) {
for (taxon in taxons){
data_name <- get(paste0("themore_",run,"_",taxon))
vari_name <- paste0("final_",run,"_",taxon)
assign(vari_name, subset(data_name, data_name[,1] != "unclassified"))   #for unclassified data
# assign(vari_name, subset(data_name, !is.na(data_name[,1])))             #for N.A. data
rm(data_name, vari_name)
}
rm(run, taxon)
}
